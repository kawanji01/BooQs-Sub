<div class="badge-modal-wrapper" id="captions-modal">
  <div class="overlay close-captions-modal">
    <div class="close-btn">
      <i class="fal fa-times"></i>
    </div>
  </div>

  <div class="modal-booqs" id="captions-<%= @token %>">


    <h3 class="my-4 font-weight-bold" id="modal-title"><%= t 'subtitles.select_download_caption' %></h3>

    <div id="contents-form">
      <%= form_with url: download_caption_subtitles_path, remote: true, method: :post do |f| %>
        <%= f.hidden_field :url, value: @url %>
        <%= f.hidden_field :token, value: @token %>
        <div id="scraping-error-massages"></div>
        <h5 class="text-secondary font-weight-normal"><%= @title %></h5>

        <% if @image.present? %>
          <div class="d-block mt-2 mb-4">
            <%= image_tag @image, class: 'img-fluid w-25 mb-2' %>
          </div>
        <% end %>

        <% if @lang_code.present? %>

          <% @lang_code.each do |code| %>
            <% next if Lang.lang_code_unsupported?(code) && code != 'auto-generated' && code != 'none' %>

            <% if code == 'auto-generated' %>
              <div class="form-check form-check-inline">
                <!-- caption一覧に、記事の言語と一致するものがなかった場合、自動文字起こしにチェックを入れる。 -->
                <%= radio_button_tag :transcript, code, class: 'form-check-input mr-2', id: "transcript-of-#{code}" %>
                <label class="form-check-label mr-2" for="transcript-of-<%= code %>"> </label>

                <%= f.select :auto_sub_lang_code, options_for_select(@auto_sub_codes.map { |code| ["#{t("subtitles.auto_sub")}：#{t("lang.#{code}")}", code] }, @locale.to_s),
                             {},
                             { class: 'form-control form-control-sm my-3' } %>

              </div>
            <% else %>
              <div class="form-check form-check-inline">
                <%= radio_button_tag :transcript, code, class: 'form-check-input mr-2' %>
                <label class="form-check-label ml-2" for="transcript_<%= code %>"><%= lang_code_to_lang_name(code) %></label>
              </div>
            <% end %>
          <% end %>

          <%= button_tag type: 'submit', class: "btn btn-lg btn-info loading-show-btn mt-5 w-100 font-weight-bold" do %>
            <%= t 'subtitles.download' %>
          <% end %>
          <div class="loading is-hide">
            <div class="loading_icon"></div>
          </div>

        <% else %>

          <p class="text-danger"><%= t 'subtitles.there_are_no_subtitles' %></p>
          <p class="text-danger"><%= t('subtitles.recommend_transcription') %></p>

          <%= link_to transcriber_path do %>
            <div class="btn btn-lg btn-info loading-show-btn my-3 w-100 font-weight-bold">
              <%= t('subtitles.transcribe') %>
            </div>
          <% end %>

        <% end %>

      <% end %>
    </div>


  </div>
</div>

